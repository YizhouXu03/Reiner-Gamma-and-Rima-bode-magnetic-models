load test_lptanikani50rbde.mat
lon=test_lptanikani50rbde(:,1);
lat=test_lptanikani50rbde(:,2);
h=test_lptanikani50rbde(:,3);
bdx=test_lptanikani50rbde(:,4);
bdy=test_lptanikani50rbde(:,5);
bdz=test_lptanikani50rbde(:,6);
A=[lon,lat,h];
C=weizhi(A);
x=C(:,1);
y=C(:,2);
z=C(:,3);
[bdr, bdt, bdp] = convert_B_xyz_to_sph(x, y, z, bdx, bdy, bdz);
bdtotal=sqrt(bdr.^2+bdt.^2+bdp.^2);
n=length(bdx);
fpath1='D:\';
load bm_xyzrb.mat
bmx=bm_xyzrb(:,3);
bmy=bm_xyzrb(:,4);
bmz=bm_xyzrb(:,5);
[bmr, bmt, bmp] = convert_B_xyz_to_sph(x, y, z, bmx, bmy, bmz);
bmtotal=sqrt(bmr.^2+bmt.^2+bmp.^2);
dx=bdx-bmx;
dy=bdy-bmy;
dz=bdz-bmz;
dr=bdr-bmr;
dt=bdt-bmt;
dp=bdp-bmp;
dtotal=bdtotal-bmtotal;
sx=sqrt(dx'*dx/n);
sy=sqrt(dy'*dy/n);
sz=sqrt(dz'*dz/n);
sr=sqrt(dr'*dr/n);
st=sqrt(dt'*dt/n);
sp=sqrt(dp'*dp/n);
stotal=sqrt(dtotal'*dtotal/n);
in=readtable('testrbr20.txt');
brr=table2array(in(:,1));
brt=table2array(in(:,2));
brp=table2array(in(:,3));
brtotal=sqrt(brr.^2+brt.^2+brp.^2);
longitude_rad = deg2rad(lon);
latitude_rad = deg2rad(lat);
colatitude = pi/2 - latitude_rad;
n = length(brr);
Bx = zeros(1, n);
By = zeros(1, n);
Bz = zeros(1, n);
for i = 1:n
    theta = colatitude(i);
    phi = longitude_rad(i);
    Bx(i) = brr(i)*sin(theta)*cos(phi) + brt(i)*cos(theta)*cos(phi) - brp(i)*sin(phi);
    By(i) = brr(i)*sin(theta)*sin(phi) + brt(i)*cos(theta)*sin(phi) + brp(i)*cos(phi);
    Bz(i) = brr(i)*cos(theta) - brt(i)*sin(theta);
end
brx=Bx';
bry=By';
brz=Bz';
drx=bdx-brx;
dry=bdy-bry;
drz=bdz-brz;
drr=bdr-brr;
drt=bdt-brt;
drp=bdp-brp;
drtotal=bdtotal-brtotal;
srx=sqrt(drx'*drx/n);
sry=sqrt(dry'*dry/n);
srz=sqrt(drz'*drz/n);
srr=sqrt(drr'*drr/n);
srt=sqrt(drt'*drt/n);
srp=sqrt(drp'*drp/n);
srtotal=sqrt(drtotal'*drtotal/n);
in2=readtable('testrbt15.txt');
btr=table2array(in2(:,1));
btt=table2array(in2(:,2));
btp=table2array(in2(:,3));
bttotal=sqrt(btr.^2+btt.^2+btp.^2);
longitude_rad = deg2rad(lon);
latitude_rad = deg2rad(lat);
colatitude = pi/2 - latitude_rad;
n = length(btr);
Btx = zeros(1, n);
Bty = zeros(1, n);
Btz = zeros(1, n);
for i = 1:n
    theta = colatitude(i);
    phi = longitude_rad(i);
    Btx(i) = btr(i)*sin(theta)*cos(phi) + btt(i)*cos(theta)*cos(phi) - btp(i)*sin(phi);
    Bty(i) = btr(i)*sin(theta)*sin(phi) + btt(i)*cos(theta)*sin(phi) + btp(i)*cos(phi);
    Btz(i) = btr(i)*cos(theta) - btt(i)*sin(theta);
end
btx=Btx';
bty=Bty';
btz=Btz';
dtx=bdx-btx;
dty=bdy-bty;
dtz=bdz-btz;
dtr=bdr-btr;
dtt=bdt-btt;
dtp=bdp-btp;
dttotal=bdtotal-bttotal;
stx=sqrt(dtx'*dtx/n);
sty=sqrt(dty'*dty/n);
stz=sqrt(dtz'*dtz/n);
str=sqrt(dtr'*dtr/n);
stt=sqrt(dtt'*dtt/n);
stp=sqrt(dtp'*dtp/n);
sttotal=sqrt(dttotal'*dttotal/n);
data=[sx,srx,stx;sy,sry,sty;sz,srz,stz;sr,srr,str;st,srt,stt;sp,srp,stp;stotal,srtotal,sttotal];